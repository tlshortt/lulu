---
phase: 03-multi-session-orchestration
plan: 03
type: execute
wave: 2
depends_on:
  - 03-01
files_modified:
  - src/lib/types/session.ts
  - src/lib/stores/sessions.ts
  - src/lib/components/Sidebar.svelte
  - src/lib/components/Sidebar.test.ts
  - src/lib/__tests__/sessions.dashboard.test.ts
  - src/lib/components/MainArea.svelte
  - src/lib/components/MainArea.test.ts
autonomous: true
must_haves:
  truths:
    - Dashboard list shows each session row with name, status badge, and right-aligned compact activity age
    - List statuses shown to user are exactly Starting, Running, Completed, Failed
    - Running rows have subtle pulsing dot, Completed uses green badge only, Failed uses red badge only with no extra motion
    - Failed rows show one-line inline reason while full error details remain in session detail output
    - Single click selects a row and double click opens that session detail stream
    - Rows stay newest-first by creation time and do not reorder on status changes
  artifacts:
    - path: src/lib/stores/sessions.ts
      provides: Dashboard row projection state and relative activity-age updates
    - path: src/lib/components/Sidebar.svelte
      provides: Two-line density dashboard list UI with locked interaction and status behavior
    - path: src/lib/__tests__/sessions.dashboard.test.ts
      provides: Regression coverage for locked dashboard decisions
  key_links:
    - from: src/lib/stores/sessions.ts
      to: src/lib/components/Sidebar.svelte
      via: row projection binding with status, age, and failure reason
      pattern: dashboard|recentActivity|failure
    - from: src/lib/components/Sidebar.svelte
      to: src/lib/stores/sessions.ts
      via: single click select + double click open detail handlers
      pattern: onclick|ondblclick
    - from: src/lib/stores/sessions.ts
      to: session-event
      via: immediate running-to-terminal state updates
      pattern: routeSessionEvent|updateSessionStatus
---

<objective>
Deliver the locked Phase 3 dashboard UX for multi-session monitoring: stable list ordering, four-status rendering, compact activity age, and row interactions for select/open.

Purpose: satisfy SESS-02 and SESS-03 with exact user-approved list behavior while preserving existing live session detail viewing.
Output: updated store projection/types, dashboard list UI implementation, and frontend behavior tests.
</objective>

<execution_context>
@/Users/timothyshortt/.config/opencode/get-shit-done/workflows/execute-plan.md
@/Users/timothyshortt/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/REQUIREMENTS.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-multi-session-orchestration/03-CONTEXT.md
@.planning/phases/03-multi-session-orchestration/03-RESEARCH.md
@.planning/phases/03-multi-session-orchestration/03-01-PLAN.md
@src/lib/stores/sessions.ts
@src/lib/components/Sidebar.svelte
@src/lib/components/MainArea.svelte
</context>

<tasks>

<task type="auto">
  <name>Task 1: Implement locked dashboard row projection in store/types</name>
  <files>src/lib/types/session.ts, src/lib/stores/sessions.ts</files>
  <action>Introduce a dashboard-row projection model exposing only required row fields: session name, locked status, compact recent activity age, and optional one-line failure reason. Normalize any backend/internal status aliases to exactly `Starting|Running|Completed|Failed` in list-facing state. Format activity age as compact relative labels (`5s`, `2m`, `1h`) and keep metadata field right-align friendly. Do not add percentage progress, running subtext, stale warnings, grouped sections, or status-driven re-sorting.</action>
  <verify>npm run test:unit -- sessions.dashboard</verify>
  <done>Store returns deterministic newest-first dashboard rows with strict four-status vocabulary and compact age labels.</done>
</task>

<task type="auto">
  <name>Task 2: Render locked dashboard list behavior and interactions</name>
  <files>src/lib/components/Sidebar.svelte, src/lib/components/MainArea.svelte, src/lib/components/Sidebar.test.ts, src/lib/components/MainArea.test.ts</files>
  <action>Render a flat, internally scrollable, comfortable two-line row list in `Sidebar.svelte` with mandatory fields only: name, status badge, and right-aligned age metadata. Apply subtle pulsing dot only for Running; render Completed as green badge only; render Failed as red badge only with no extra motion. Keep completed/failed rows in normal newest-first flow and show one-line inline failure reason truncation. Implement single-click select and double-click open-detail behavior (detail remains session output in `MainArea.svelte`).</action>
  <verify>npm run test:unit -- Sidebar MainArea</verify>
  <done>Sidebar behavior matches locked selection/open interactions and locked row rendering without auto-reorder side effects.</done>
</task>

<task type="auto">
  <name>Task 3: Add regression coverage for all locked dashboard constraints</name>
  <files>src/lib/__tests__/sessions.dashboard.test.ts, src/lib/components/Sidebar.test.ts, src/lib/stores/sessions.ts</files>
  <action>Add focused tests asserting locked constraints end-to-end in store + sidebar rendering: exact four-status vocabulary, no percentage progress text, no running subtext, right-aligned compact age labels, immediate running pulse stop on terminal state, newest-first stable ordering, one-line inline failure reason, single-click select, and double-click open-detail behavior. Keep tests deterministic with controlled timestamps and seeded store rows.</action>
  <verify>npm run test:unit -- sessions.dashboard Sidebar</verify>
  <done>Frontend regression suite protects locked Phase 3 dashboard decisions from drift.</done>
</task>

</tasks>

<verification>
Run `npm run test:unit -- sessions.dashboard Sidebar MainArea` and verify locked dashboard behavior assertions all pass.
</verification>

<success_criteria>
The dashboard presents a stable newest-first flat list where every row shows name + locked status + compact recent activity age, and users can select/open any session without progress meters, subgrouping, or status drift.
</success_criteria>

<output>
After completion, create `.planning/phases/03-multi-session-orchestration/03-multi-session-orchestration-03-SUMMARY.md`
</output>
