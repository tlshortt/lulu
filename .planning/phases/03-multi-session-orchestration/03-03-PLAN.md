---
phase: 03-multi-session-orchestration
plan: 03
type: execute
wave: 2
depends_on:
  - 03-01
files_modified:
  - src/lib/types/session.ts
  - src/lib/stores/sessions.ts
  - src/lib/components/Sidebar.svelte
  - src/lib/components/MainArea.svelte
  - src/lib/__tests__/sessions.dashboard.test.ts
  - src/lib/components/MainArea.test.ts
autonomous: true
must_haves:
  truths:
    - Dashboard list shows each session row with name, status badge, and right-aligned compact activity age
    - List statuses shown to user are exactly Starting, Running, Completed, Failed
    - Running rows have subtle pulsing dot, Completed uses green badge only, Failed uses red badge only with no extra motion
    - Failed rows show one-line inline reason while full error details remain in session detail output
    - Single click selects a row and double click opens that session detail stream
    - Rows stay newest-first by creation time and do not reorder on status changes
  artifacts:
    - path: src/lib/stores/sessions.ts
      provides: Dashboard row projection state and relative activity-age updates
    - path: src/lib/components/Sidebar.svelte
      provides: Two-line density dashboard list UI with locked interaction and status behavior
    - path: src/lib/__tests__/sessions.dashboard.test.ts
      provides: Regression coverage for locked dashboard decisions
  key_links:
    - from: src/lib/stores/sessions.ts
      to: src/lib/components/Sidebar.svelte
      via: row projection binding with status, age, and failure reason
      pattern: dashboard|recentActivity|failure
    - from: src/lib/components/Sidebar.svelte
      to: src/lib/stores/sessions.ts
      via: single click select + double click open detail handlers
      pattern: onclick|ondblclick
    - from: src/lib/stores/sessions.ts
      to: session-event
      via: immediate running-to-terminal state updates
      pattern: routeSessionEvent|updateSessionStatus
---

<objective>
Deliver the locked Phase 3 dashboard UX for multi-session monitoring: stable list ordering, four-status rendering, compact activity age, and row interactions for select/open.

Purpose: satisfy SESS-02 and SESS-03 with exact user-approved list behavior while preserving existing live session detail viewing.
Output: updated store projection/types, dashboard list UI implementation, and frontend behavior tests.
</objective>

<execution_context>
@/Users/timothyshortt/.config/opencode/get-shit-done/workflows/execute-plan.md
@/Users/timothyshortt/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/REQUIREMENTS.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-multi-session-orchestration/03-CONTEXT.md
@.planning/phases/03-multi-session-orchestration/03-RESEARCH.md
@.planning/phases/03-multi-session-orchestration/03-01-PLAN.md
@src/lib/stores/sessions.ts
@src/lib/components/Sidebar.svelte
@src/lib/components/MainArea.svelte
</context>

<tasks>

<task type="auto">
  <name>Implement dashboard row projection state with locked status and compact activity age</name>
  <files>src/lib/types/session.ts, src/lib/stores/sessions.ts</files>
  <action>Introduce a dashboard-facing row model in the store that exposes only required fields (name, status, recent activity age, optional inline failure reason) and maps backend/internal statuses to locked UX statuses: `starting`, `running`, `completed`, `failed`. Format activity age as compact relative labels (`5s`, `2m`, `1h`) and keep age right-align ready. Do not add percent progress, running subtext labels, stale warnings, or extra status groups.</action>
  <verify>npm run test:unit -- sessions.dashboard</verify>
  <done>Store provides deterministic dashboard rows with stable newest-first ordering and immediate terminal-state running-indicator stop semantics.</done>
</task>

<task type="auto">
  <name>Update sidebar list UI to match locked row density, badges, and interaction model</name>
  <files>src/lib/components/Sidebar.svelte, src/lib/components/MainArea.svelte</files>
  <action>Render a flat internally scrollable two-line row list with mandatory fields: session name, status badge, and right-aligned compact activity age. Apply subtle pulsing dot for running only, completed green badge only, failed red badge only with no extra motion. Keep rows in newest-first flow even after terminal transitions and show one-line inline failure reason truncation in row. Implement single-click row select and double-click open detail behavior (detail view remains MainArea session output; do not repurpose double-click for rename).</action>
  <verify>npm run test:unit -- MainArea</verify>
  <done>Dashboard rows match all locked visual/behavior decisions and open any session detail stream via double-click without reordering side effects.</done>
</task>

<task type="auto">
  <name>Add regression tests for locked dashboard decisions</name>
  <files>src/lib/__tests__/sessions.dashboard.test.ts, src/lib/components/MainArea.test.ts, src/lib/stores/sessions.ts</files>
  <action>Add focused tests asserting locked constraints: exact status vocabulary, no progress text, no running subtext, right-aligned compact age output, immediate running pulse stop on terminal status, newest-first stable ordering, inline one-line failure reason, and single-click/double-click interaction semantics. Keep tests deterministic by controlling timestamps and store inputs.</action>
  <verify>npm run test:unit -- sessions.dashboard MainArea</verify>
  <done>Frontend test suite protects all locked Phase 3 dashboard decisions against regressions.</done>
</task>

</tasks>

<verification>
Run `npm run test:unit -- sessions.dashboard MainArea` and manually inspect the sidebar list in dev mode to confirm badge colors, running pulse, row density, and click/double-click behavior.
</verification>

<success_criteria>
The dashboard presents a stable newest-first flat list where every row shows name + locked status + compact recent activity age, and users can select/open any session without progress meters, subgrouping, or status drift.
</success_criteria>

<output>
After completion, create `.planning/phases/03-multi-session-orchestration/03-multi-session-orchestration-03-SUMMARY.md`
</output>
